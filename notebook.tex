
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{ANN - CIFAR 10}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{CNN}\label{cnn}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        
        \PY{k+kn}{import} \PY{n+nn}{plotly} \PY{k}{as} \PY{n+nn}{plty}
        \PY{k+kn}{import} \PY{n+nn}{sklearn} \PY{k}{as} \PY{n+nn}{skl}
        
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{mlab} \PY{k}{as} \PY{n+nn}{mlabQ}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        
        \PY{k+kn}{from} \PY{n+nn}{copy} \PY{k}{import} \PY{n}{copy} \PY{k}{as} \PY{n}{copy}
        \PY{k+kn}{from} \PY{n+nn}{pprint} \PY{k}{import} \PY{n}{pprint}
        
        \PY{k+kn}{import} \PY{n+nn}{sys}
        \PY{k+kn}{import} \PY{n+nn}{os}
        
        
        \PY{k}{def} \PY{n+nf}{unpickle}\PY{p}{(}\PY{n}{file}\PY{p}{)}\PY{p}{:}
            \PY{k+kn}{import} \PY{n+nn}{pickle}
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{fo}\PY{p}{:}
                \PY{n+nb}{dict} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{fo}\PY{p}{,} \PY{n}{encoding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bytes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{k}{return} \PY{n+nb}{dict}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{k+kn}{import} \PY{n+nn}{tensorflow} \PY{k}{as} \PY{n+nn}{tf}
        \PY{k+kn}{import} \PY{n+nn}{keras}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Using TensorFlow backend.

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Sequential}
         \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{layers} \PY{k}{import} \PY{n}{Dense}\PY{p}{,} \PY{n}{Conv2D}\PY{p}{,} \PY{n}{MaxPooling2D}\PY{p}{,} \PY{n}{Dropout}\PY{p}{,} \PY{n}{Flatten}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{ds\PYZus{}path} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{abspath}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/cifar\PYZhy{}10\PYZhy{}batches\PYZhy{}py/}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{batch\PYZus{}container} \PY{o}{=} \PY{p}{[} \PY{k+kc}{None} \PY{k}{for} \PY{n}{\PYZus{}} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{ii} \PY{o+ow}{in} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{ds\PYZus{}path}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{data}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{ii}\PY{p}{:}
                 \PY{n}{current\PYZus{}id} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{ii}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}
                 \PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{current\PYZus{}id}\PY{p}{]} \PY{o}{=} \PY{n}{unpickle}\PY{p}{(}\PY{n}{ds\PYZus{}path} \PY{o}{+} \PY{n}{ii}\PY{p}{)}
                 
                 \PY{n}{dummy} \PY{o}{=} \PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{current\PYZus{}id}\PY{p}{]}
                 \PY{n}{kkeys} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{dummy}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         
                 \PY{k}{for} \PY{n}{kk} \PY{o+ow}{in} \PY{n}{kkeys}\PY{p}{:}
                     \PY{n}{dummy}\PY{p}{[}\PY{n+nb}{repr}\PY{p}{(}\PY{n}{kk}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{dummy}\PY{o}{.}\PY{n}{pop}\PY{p}{(}\PY{n}{kk}\PY{p}{)}      
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{keys\PYZus{}ids} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{batch\PYZus{}label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{labels}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{filenames}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k}{for} \PY{n}{ii} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{ii} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{repr}\PY{p}{(}\PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{ii}\PY{p}{]}\PY{p}{[}\PY{n}{keys\PYZus{}ids}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
             \PY{k}{for} \PY{n}{keys\PYZus{}} \PY{o+ow}{in} \PY{n}{keys\PYZus{}ids}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{ii}\PY{p}{]}\PY{p}{[}\PY{n}{keys\PYZus{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1
training batch 1 of 5
10000
10000
10000
2
training batch 2 of 5
10000
10000
10000
3
training batch 3 of 5
10000
10000
10000
4
training batch 4 of 5
10000
10000
10000
5
training batch 5 of 5
10000
10000
10000

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{x\PYZus{}data} \PY{o}{=} \PY{p}{[} \PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{ii}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{k}{for} \PY{n}{ii} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{]}
         \PY{n}{y\PYZus{}data} \PY{o}{=} \PY{p}{[} \PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{n}{ii}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{labels}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{k}{for} \PY{n}{ii} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{imgplot} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
         \PY{n}{batch\PYZus{}container}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{labels}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} 2
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{k+kn}{from} \PY{n+nn}{keras}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k}{import} \PY{n}{cifar10}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Paramethers}
         
         \PY{n}{num\PYZus{}classes} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{c+c1}{\PYZsh{} The data, split between train and test sets:}
         \PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)} \PY{o}{=} \PY{n}{cifar10}\PY{o}{.}\PY{n}{load\PYZus{}data}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x\PYZus{}train shape:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{x\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test samples}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Convert class vectors to binary class matrices.}
         \PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{keras}\PY{o}{.}\PY{n}{utils}\PY{o}{.}\PY{n}{to\PYZus{}categorical}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{num\PYZus{}classes}\PY{p}{)}
         \PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{keras}\PY{o}{.}\PY{n}{utils}\PY{o}{.}\PY{n}{to\PYZus{}categorical}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{num\PYZus{}classes}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
x\_train shape: (50000, 32, 32, 3)
50000 train samples
10000 test samples

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{imgplot} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{]}\PY{p}{,}\PY{n}{shape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}
         \PY{n}{x\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{]}\PY{o}{.}\PY{n}{shape}\PY{p}{,}
         \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{]}\PY{p}{,}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(32, 32, 3) [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{Both image above are the same, but the first has being load from
Disk and the other dowload directly from the Keras Repo. Dataset.}

\begin{quote}
we are gonna work using the second loaded dataset
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}Architecture}
         \PY{k}{def} \PY{n+nf}{createModel}\PY{p}{(}\PY{n}{input\PYZus{}shape}\PY{p}{,} \PY{n}{nClasses}\PY{p}{)}\PY{p}{:}
             \PY{n}{model} \PY{o}{=} \PY{n}{Sequential}\PY{p}{(}\PY{p}{)}
             
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{36}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{same}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{input\PYZus{}shape}\PY{o}{=}\PY{n}{input\PYZus{}shape}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{36}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{selu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{MaxPooling2D}\PY{p}{(}\PY{n}{pool\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.2}\PY{p}{)}\PY{p}{)}
          
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{48}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{same}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{selu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{48}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{MaxPooling2D}\PY{p}{(}\PY{n}{pool\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{64}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{padding}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{same}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Conv2D}\PY{p}{(}\PY{l+m+mi}{64}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{selu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{MaxPooling2D}\PY{p}{(}\PY{n}{pool\PYZus{}size}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.3}\PY{p}{)}\PY{p}{)}
          
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Flatten}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{selu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{l+m+mi}{300}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{relu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dropout}\PY{p}{(}\PY{l+m+mf}{0.4}\PY{p}{)}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{add}\PY{p}{(}\PY{n}{Dense}\PY{p}{(}\PY{n}{nClasses}\PY{p}{,} \PY{n}{activation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{softmax}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
              
             \PY{k}{return} \PY{n}{model}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{150}
         \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{1000}
         
         \PY{n}{model1} \PY{o}{=} \PY{n}{createModel}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{num\PYZus{}classes}\PY{p}{)}
         
         \PY{n}{model1}\PY{o}{.}\PY{n}{compile}\PY{p}{(}\PY{n}{optimizer}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adadelta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{categorical\PYZus{}crossentropy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{metrics}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{model1}\PY{o}{.}\PY{n}{summary}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Layer (type)                 Output Shape              Param \#   
=================================================================
conv2d\_14 (Conv2D)           (None, 32, 32, 36)        1008      
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
conv2d\_15 (Conv2D)           (None, 31, 31, 36)        5220      
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
max\_pooling2d\_7 (MaxPooling2 (None, 15, 15, 36)        0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dropout\_13 (Dropout)         (None, 15, 15, 36)        0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
conv2d\_16 (Conv2D)           (None, 15, 15, 48)        6960      
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
conv2d\_17 (Conv2D)           (None, 12, 12, 48)        36912     
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
max\_pooling2d\_8 (MaxPooling2 (None, 6, 6, 48)          0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dropout\_14 (Dropout)         (None, 6, 6, 48)          0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
conv2d\_18 (Conv2D)           (None, 6, 6, 64)          27712     
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
conv2d\_19 (Conv2D)           (None, 4, 4, 64)          36928     
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
max\_pooling2d\_9 (MaxPooling2 (None, 2, 2, 64)          0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dropout\_15 (Dropout)         (None, 2, 2, 64)          0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
flatten\_3 (Flatten)          (None, 256)               0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_8 (Dense)              (None, 500)               128500    
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dropout\_16 (Dropout)         (None, 500)               0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_9 (Dense)              (None, 300)               150300    
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dropout\_17 (Dropout)         (None, 300)               0         
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
dense\_10 (Dense)             (None, 10)                3010      
=================================================================
Total params: 396,550
Trainable params: 396,550
Non-trainable params: 0
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{history} \PY{o}{=} \PY{n}{model1}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,} \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} 
                            \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{model1}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train on 50000 samples, validate on 10000 samples
Epoch 1/150
50000/50000 [==============================] - 26s 517us/step - loss: 4.1048 - acc: 0.1031 - val\_loss: 2.3025 - val\_acc: 0.1021
Epoch 2/150
50000/50000 [==============================] - 23s 453us/step - loss: 2.3094 - acc: 0.1177 - val\_loss: 2.3050 - val\_acc: 0.1039
Epoch 3/150
50000/50000 [==============================] - 23s 454us/step - loss: 2.2726 - acc: 0.1383 - val\_loss: 2.2852 - val\_acc: 0.1347
Epoch 4/150
50000/50000 [==============================] - 23s 456us/step - loss: 2.1998 - acc: 0.1792 - val\_loss: 2.3063 - val\_acc: 0.1337
Epoch 5/150
50000/50000 [==============================] - 23s 458us/step - loss: 2.0841 - acc: 0.2122 - val\_loss: 2.0400 - val\_acc: 0.2514
Epoch 6/150
50000/50000 [==============================] - 23s 457us/step - loss: 2.0459 - acc: 0.2379 - val\_loss: 2.1421 - val\_acc: 0.2196
Epoch 7/150
50000/50000 [==============================] - 23s 460us/step - loss: 1.8977 - acc: 0.2861 - val\_loss: 1.7188 - val\_acc: 0.3746
Epoch 8/150
50000/50000 [==============================] - 23s 460us/step - loss: 1.8490 - acc: 0.3064 - val\_loss: 2.0928 - val\_acc: 0.2474
Epoch 9/150
50000/50000 [==============================] - 25s 493us/step - loss: 1.8472 - acc: 0.3157 - val\_loss: 1.7671 - val\_acc: 0.3617
Epoch 10/150
50000/50000 [==============================] - 23s 464us/step - loss: 1.7634 - acc: 0.3476 - val\_loss: 1.9620 - val\_acc: 0.2822
Epoch 11/150
50000/50000 [==============================] - 23s 461us/step - loss: 1.7247 - acc: 0.3659 - val\_loss: 1.5578 - val\_acc: 0.4348
Epoch 12/150
50000/50000 [==============================] - 23s 470us/step - loss: 1.6912 - acc: 0.3822 - val\_loss: 1.5419 - val\_acc: 0.4310
Epoch 13/150
50000/50000 [==============================] - 23s 467us/step - loss: 1.6411 - acc: 0.4004 - val\_loss: 1.5400 - val\_acc: 0.4351
Epoch 14/150
50000/50000 [==============================] - 23s 465us/step - loss: 1.6474 - acc: 0.4016 - val\_loss: 1.5020 - val\_acc: 0.4442
Epoch 15/150
50000/50000 [==============================] - 23s 466us/step - loss: 1.5740 - acc: 0.4281 - val\_loss: 1.7970 - val\_acc: 0.3376
Epoch 16/150
50000/50000 [==============================] - 24s 481us/step - loss: 1.5411 - acc: 0.4397 - val\_loss: 1.3627 - val\_acc: 0.5071
Epoch 17/150
50000/50000 [==============================] - 24s 472us/step - loss: 1.4963 - acc: 0.4578 - val\_loss: 1.3137 - val\_acc: 0.5304
Epoch 18/150
50000/50000 [==============================] - 23s 460us/step - loss: 1.4409 - acc: 0.4798 - val\_loss: 1.3636 - val\_acc: 0.5232
Epoch 19/150
50000/50000 [==============================] - 23s 461us/step - loss: 1.4239 - acc: 0.4894 - val\_loss: 1.2308 - val\_acc: 0.5645
Epoch 20/150
50000/50000 [==============================] - 23s 458us/step - loss: 1.3788 - acc: 0.5054 - val\_loss: 1.2851 - val\_acc: 0.5380
Epoch 21/150
50000/50000 [==============================] - 24s 470us/step - loss: 1.3472 - acc: 0.5169 - val\_loss: 1.3777 - val\_acc: 0.5229
Epoch 22/150
50000/50000 [==============================] - 24s 470us/step - loss: 1.3203 - acc: 0.5303 - val\_loss: 1.2484 - val\_acc: 0.5602
Epoch 23/150
50000/50000 [==============================] - 23s 465us/step - loss: 1.3059 - acc: 0.5382 - val\_loss: 1.1391 - val\_acc: 0.6005
Epoch 24/150
50000/50000 [==============================] - 25s 492us/step - loss: 1.2345 - acc: 0.5597 - val\_loss: 1.1216 - val\_acc: 0.6050
Epoch 25/150
50000/50000 [==============================] - 23s 463us/step - loss: 1.2316 - acc: 0.5633 - val\_loss: 1.1200 - val\_acc: 0.5999
Epoch 26/150
50000/50000 [==============================] - 24s 470us/step - loss: 1.2036 - acc: 0.5751 - val\_loss: 1.1288 - val\_acc: 0.5938
Epoch 27/150
50000/50000 [==============================] - 24s 472us/step - loss: 1.1786 - acc: 0.5835 - val\_loss: 1.3112 - val\_acc: 0.5467
Epoch 28/150
50000/50000 [==============================] - 24s 474us/step - loss: 1.1699 - acc: 0.5874 - val\_loss: 0.9889 - val\_acc: 0.6507
Epoch 29/150
50000/50000 [==============================] - 24s 479us/step - loss: 1.1306 - acc: 0.5996 - val\_loss: 1.0084 - val\_acc: 0.6433
Epoch 30/150
50000/50000 [==============================] - 24s 479us/step - loss: 1.1063 - acc: 0.6090 - val\_loss: 0.9349 - val\_acc: 0.6694
Epoch 31/150
50000/50000 [==============================] - 24s 485us/step - loss: 1.0982 - acc: 0.6143 - val\_loss: 0.9674 - val\_acc: 0.6542
Epoch 32/150
50000/50000 [==============================] - 26s 516us/step - loss: 1.1093 - acc: 0.6102 - val\_loss: 1.1231 - val\_acc: 0.6114
Epoch 33/150
50000/50000 [==============================] - 24s 483us/step - loss: 1.0484 - acc: 0.6322 - val\_loss: 1.0031 - val\_acc: 0.6543
Epoch 34/150
50000/50000 [==============================] - 24s 483us/step - loss: 1.0714 - acc: 0.6260 - val\_loss: 0.9257 - val\_acc: 0.6821
Epoch 35/150
50000/50000 [==============================] - 24s 484us/step - loss: 1.0032 - acc: 0.6492 - val\_loss: 0.9038 - val\_acc: 0.6801
Epoch 36/150
50000/50000 [==============================] - 24s 487us/step - loss: 1.0172 - acc: 0.6449 - val\_loss: 1.1385 - val\_acc: 0.6015
Epoch 37/150
50000/50000 [==============================] - 24s 487us/step - loss: 1.0099 - acc: 0.6475 - val\_loss: 0.8963 - val\_acc: 0.6894
Epoch 38/150
50000/50000 [==============================] - 24s 488us/step - loss: 0.9775 - acc: 0.6614 - val\_loss: 0.8680 - val\_acc: 0.7026
Epoch 39/150
50000/50000 [==============================] - 26s 524us/step - loss: 0.9635 - acc: 0.6657 - val\_loss: 0.8665 - val\_acc: 0.6939
Epoch 40/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.9580 - acc: 0.6694 - val\_loss: 0.8520 - val\_acc: 0.7069
Epoch 41/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.9473 - acc: 0.6711 - val\_loss: 0.8079 - val\_acc: 0.7191
Epoch 42/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.9288 - acc: 0.6771 - val\_loss: 0.8146 - val\_acc: 0.7194
Epoch 43/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.9269 - acc: 0.6812 - val\_loss: 0.8130 - val\_acc: 0.7171
Epoch 44/150
50000/50000 [==============================] - 24s 487us/step - loss: 0.9141 - acc: 0.6863 - val\_loss: 0.7720 - val\_acc: 0.7345
Epoch 45/150
50000/50000 [==============================] - 24s 488us/step - loss: 0.8919 - acc: 0.6929 - val\_loss: 0.7554 - val\_acc: 0.7365
Epoch 46/150
50000/50000 [==============================] - 26s 514us/step - loss: 0.8890 - acc: 0.6955 - val\_loss: 0.7797 - val\_acc: 0.7289
Epoch 47/150
50000/50000 [==============================] - 24s 490us/step - loss: 0.8618 - acc: 0.7021 - val\_loss: 0.8186 - val\_acc: 0.7245
Epoch 48/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.8849 - acc: 0.6979 - val\_loss: 0.8367 - val\_acc: 0.7138
Epoch 49/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.8367 - acc: 0.7111 - val\_loss: 0.7441 - val\_acc: 0.7440
Epoch 50/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.8634 - acc: 0.7030 - val\_loss: 0.7704 - val\_acc: 0.7362
Epoch 51/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.8342 - acc: 0.7144 - val\_loss: 0.7763 - val\_acc: 0.7337
Epoch 52/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.8270 - acc: 0.7181 - val\_loss: 0.8403 - val\_acc: 0.7070
Epoch 53/150
50000/50000 [==============================] - 25s 500us/step - loss: 0.8361 - acc: 0.7164 - val\_loss: 0.7213 - val\_acc: 0.7518
Epoch 54/150
50000/50000 [==============================] - 26s 518us/step - loss: 0.8014 - acc: 0.7276 - val\_loss: 0.7968 - val\_acc: 0.7205
Epoch 55/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.8194 - acc: 0.7191 - val\_loss: 0.7379 - val\_acc: 0.7482
Epoch 56/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.7870 - acc: 0.7302 - val\_loss: 0.7032 - val\_acc: 0.7575
Epoch 57/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.7894 - acc: 0.7317 - val\_loss: 0.7728 - val\_acc: 0.7397
Epoch 58/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.7778 - acc: 0.7349 - val\_loss: 0.7629 - val\_acc: 0.7381
Epoch 59/150
50000/50000 [==============================] - 25s 501us/step - loss: 0.7704 - acc: 0.7389 - val\_loss: 0.8262 - val\_acc: 0.7240
Epoch 60/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.7827 - acc: 0.7325 - val\_loss: 0.6611 - val\_acc: 0.7705
Epoch 61/150
50000/50000 [==============================] - 26s 524us/step - loss: 0.7606 - acc: 0.7404 - val\_loss: 0.7281 - val\_acc: 0.7504
Epoch 62/150
50000/50000 [==============================] - 24s 489us/step - loss: 0.7500 - acc: 0.7446 - val\_loss: 0.7142 - val\_acc: 0.7536
Epoch 63/150
50000/50000 [==============================] - 24s 489us/step - loss: 0.7414 - acc: 0.7480 - val\_loss: 0.6791 - val\_acc: 0.7645
Epoch 64/150
50000/50000 [==============================] - 24s 488us/step - loss: 0.7389 - acc: 0.7479 - val\_loss: 0.7054 - val\_acc: 0.7581
Epoch 65/150
50000/50000 [==============================] - 25s 492us/step - loss: 0.7355 - acc: 0.7495 - val\_loss: 0.6669 - val\_acc: 0.7731
Epoch 66/150
50000/50000 [==============================] - 24s 487us/step - loss: 0.7282 - acc: 0.7525 - val\_loss: 0.7948 - val\_acc: 0.7292
Epoch 67/150
50000/50000 [==============================] - 25s 492us/step - loss: 0.7288 - acc: 0.7547 - val\_loss: 0.7058 - val\_acc: 0.7550
Epoch 68/150
50000/50000 [==============================] - 26s 516us/step - loss: 0.7166 - acc: 0.7592 - val\_loss: 0.6782 - val\_acc: 0.7674
Epoch 69/150
50000/50000 [==============================] - 24s 484us/step - loss: 0.7311 - acc: 0.7543 - val\_loss: 0.6407 - val\_acc: 0.7796
Epoch 70/150
50000/50000 [==============================] - 24s 480us/step - loss: 0.7165 - acc: 0.7570 - val\_loss: 0.6470 - val\_acc: 0.7769
Epoch 71/150
50000/50000 [==============================] - 24s 483us/step - loss: 0.6794 - acc: 0.7685 - val\_loss: 0.6697 - val\_acc: 0.7734
Epoch 72/150
50000/50000 [==============================] - 24s 484us/step - loss: 0.6963 - acc: 0.7638 - val\_loss: 0.7041 - val\_acc: 0.7600
Epoch 73/150
50000/50000 [==============================] - 24s 489us/step - loss: 0.7020 - acc: 0.7646 - val\_loss: 0.6384 - val\_acc: 0.7800
Epoch 74/150
50000/50000 [==============================] - 24s 487us/step - loss: 0.6897 - acc: 0.7641 - val\_loss: 0.7042 - val\_acc: 0.7572
Epoch 75/150
50000/50000 [==============================] - 26s 522us/step - loss: 0.6857 - acc: 0.7679 - val\_loss: 0.6820 - val\_acc: 0.7647
Epoch 76/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.7009 - acc: 0.7638 - val\_loss: 0.6227 - val\_acc: 0.7834
Epoch 77/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6681 - acc: 0.7727 - val\_loss: 0.6930 - val\_acc: 0.7668
Epoch 78/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6700 - acc: 0.7745 - val\_loss: 0.6769 - val\_acc: 0.7721
Epoch 79/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6767 - acc: 0.7693 - val\_loss: 0.6532 - val\_acc: 0.7748
Epoch 80/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.6721 - acc: 0.7726 - val\_loss: 0.6680 - val\_acc: 0.7772
Epoch 81/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.6701 - acc: 0.7736 - val\_loss: 0.6967 - val\_acc: 0.7657
Epoch 82/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6540 - acc: 0.7793 - val\_loss: 0.6819 - val\_acc: 0.7661
Epoch 83/150
50000/50000 [==============================] - 26s 524us/step - loss: 0.6676 - acc: 0.7738 - val\_loss: 0.6430 - val\_acc: 0.7828
Epoch 84/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6443 - acc: 0.7829 - val\_loss: 0.6391 - val\_acc: 0.7831
Epoch 85/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.6491 - acc: 0.7823 - val\_loss: 0.6525 - val\_acc: 0.7767
Epoch 86/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.6390 - acc: 0.7864 - val\_loss: 0.6368 - val\_acc: 0.7865
Epoch 87/150
50000/50000 [==============================] - 24s 485us/step - loss: 0.6613 - acc: 0.7778 - val\_loss: 0.5964 - val\_acc: 0.7942
Epoch 88/150
50000/50000 [==============================] - 24s 483us/step - loss: 0.6266 - acc: 0.7879 - val\_loss: 0.7646 - val\_acc: 0.7456
Epoch 89/150
50000/50000 [==============================] - 24s 486us/step - loss: 0.6186 - acc: 0.7895 - val\_loss: 0.6119 - val\_acc: 0.7897
Epoch 90/150
50000/50000 [==============================] - 26s 511us/step - loss: 0.6248 - acc: 0.7871 - val\_loss: 0.6581 - val\_acc: 0.7731
Epoch 91/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.6297 - acc: 0.7891 - val\_loss: 0.6400 - val\_acc: 0.7788
Epoch 92/150
50000/50000 [==============================] - 24s 490us/step - loss: 0.6110 - acc: 0.7933 - val\_loss: 0.5916 - val\_acc: 0.7978
Epoch 93/150
50000/50000 [==============================] - 24s 487us/step - loss: 0.6380 - acc: 0.7871 - val\_loss: 0.6249 - val\_acc: 0.7817
Epoch 94/150
50000/50000 [==============================] - 24s 487us/step - loss: 0.6026 - acc: 0.7957 - val\_loss: 0.6346 - val\_acc: 0.7804
Epoch 95/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.6104 - acc: 0.7920 - val\_loss: 0.6238 - val\_acc: 0.7896
Epoch 96/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.6304 - acc: 0.7861 - val\_loss: 0.6419 - val\_acc: 0.7836
Epoch 97/150
50000/50000 [==============================] - 26s 519us/step - loss: 0.5958 - acc: 0.7985 - val\_loss: 0.7150 - val\_acc: 0.7685
Epoch 98/150
50000/50000 [==============================] - 24s 488us/step - loss: 0.6133 - acc: 0.7918 - val\_loss: 0.6721 - val\_acc: 0.7749
Epoch 99/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.5927 - acc: 0.7997 - val\_loss: 0.5934 - val\_acc: 0.7941
Epoch 100/150
50000/50000 [==============================] - 24s 489us/step - loss: 0.5942 - acc: 0.7966 - val\_loss: 0.6077 - val\_acc: 0.7970
Epoch 101/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.5995 - acc: 0.7976 - val\_loss: 0.6397 - val\_acc: 0.7921
Epoch 102/150
50000/50000 [==============================] - 25s 492us/step - loss: 0.5850 - acc: 0.8018 - val\_loss: 0.6780 - val\_acc: 0.7723
Epoch 103/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6075 - acc: 0.7938 - val\_loss: 0.7579 - val\_acc: 0.7498
Epoch 104/150
50000/50000 [==============================] - 26s 523us/step - loss: 0.5872 - acc: 0.8014 - val\_loss: 0.6239 - val\_acc: 0.7877
Epoch 105/150
50000/50000 [==============================] - 25s 492us/step - loss: 0.6014 - acc: 0.7978 - val\_loss: 0.6564 - val\_acc: 0.7844
Epoch 106/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.5833 - acc: 0.8019 - val\_loss: 0.6493 - val\_acc: 0.7813
Epoch 107/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.5788 - acc: 0.8056 - val\_loss: 0.5873 - val\_acc: 0.8017
Epoch 108/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.6002 - acc: 0.7981 - val\_loss: 0.6544 - val\_acc: 0.7860
Epoch 109/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.5796 - acc: 0.8054 - val\_loss: 0.6594 - val\_acc: 0.7787
Epoch 110/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.5806 - acc: 0.8036 - val\_loss: 0.6083 - val\_acc: 0.7967
Epoch 111/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.5636 - acc: 0.8105 - val\_loss: 0.5749 - val\_acc: 0.8059
Epoch 112/150
50000/50000 [==============================] - 26s 521us/step - loss: 0.5792 - acc: 0.8043 - val\_loss: 0.6051 - val\_acc: 0.7957
Epoch 113/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.5635 - acc: 0.8089 - val\_loss: 0.5735 - val\_acc: 0.8048
Epoch 114/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.5672 - acc: 0.8077 - val\_loss: 0.5887 - val\_acc: 0.8031
Epoch 115/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.5723 - acc: 0.8084 - val\_loss: 0.5938 - val\_acc: 0.8002
Epoch 116/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.5650 - acc: 0.8102 - val\_loss: 0.6051 - val\_acc: 0.7944
Epoch 117/150
50000/50000 [==============================] - 25s 502us/step - loss: 0.5789 - acc: 0.8053 - val\_loss: 0.6073 - val\_acc: 0.7962
Epoch 118/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.5543 - acc: 0.8142 - val\_loss: 0.6192 - val\_acc: 0.7934
Epoch 119/150
50000/50000 [==============================] - 26s 527us/step - loss: 0.5372 - acc: 0.8182 - val\_loss: 0.6188 - val\_acc: 0.7956
Epoch 120/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.5633 - acc: 0.8119 - val\_loss: 0.6435 - val\_acc: 0.7898
Epoch 121/150
50000/50000 [==============================] - 25s 500us/step - loss: 0.5357 - acc: 0.8183 - val\_loss: 0.6266 - val\_acc: 0.7883
Epoch 122/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.5549 - acc: 0.8120 - val\_loss: 0.6286 - val\_acc: 0.7918
Epoch 123/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.5364 - acc: 0.8182 - val\_loss: 0.6298 - val\_acc: 0.7918
Epoch 124/150
50000/50000 [==============================] - 25s 496us/step - loss: 0.5755 - acc: 0.8076 - val\_loss: 0.6494 - val\_acc: 0.7831
Epoch 125/150
50000/50000 [==============================] - 25s 497us/step - loss: 0.5411 - acc: 0.8187 - val\_loss: 0.5764 - val\_acc: 0.8069
Epoch 126/150
50000/50000 [==============================] - 26s 524us/step - loss: 0.5373 - acc: 0.8195 - val\_loss: 0.5872 - val\_acc: 0.8069
Epoch 127/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.5481 - acc: 0.8165 - val\_loss: 0.6129 - val\_acc: 0.7965
Epoch 128/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.5423 - acc: 0.8171 - val\_loss: 0.5917 - val\_acc: 0.8033
Epoch 129/150
50000/50000 [==============================] - 25s 500us/step - loss: 0.5487 - acc: 0.8173 - val\_loss: 0.6018 - val\_acc: 0.7975
Epoch 130/150
50000/50000 [==============================] - 25s 501us/step - loss: 0.5206 - acc: 0.8258 - val\_loss: 0.5742 - val\_acc: 0.8074
Epoch 131/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.5399 - acc: 0.8179 - val\_loss: 0.6042 - val\_acc: 0.8006
Epoch 132/150
50000/50000 [==============================] - 25s 495us/step - loss: 0.5287 - acc: 0.8231 - val\_loss: 0.5977 - val\_acc: 0.7990
Epoch 133/150
50000/50000 [==============================] - 26s 520us/step - loss: 0.5364 - acc: 0.8157 - val\_loss: 0.6034 - val\_acc: 0.7996
Epoch 134/150
50000/50000 [==============================] - 24s 490us/step - loss: 0.5287 - acc: 0.8224 - val\_loss: 0.5657 - val\_acc: 0.8104
Epoch 135/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.5235 - acc: 0.8253 - val\_loss: 0.6058 - val\_acc: 0.7986
Epoch 136/150
50000/50000 [==============================] - 24s 488us/step - loss: 0.5325 - acc: 0.8195 - val\_loss: 0.6390 - val\_acc: 0.7930
Epoch 137/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.5348 - acc: 0.8191 - val\_loss: 0.5719 - val\_acc: 0.8100
Epoch 138/150
50000/50000 [==============================] - 25s 490us/step - loss: 0.5306 - acc: 0.8217 - val\_loss: 0.5671 - val\_acc: 0.8103
Epoch 139/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.5088 - acc: 0.8290 - val\_loss: 0.6211 - val\_acc: 0.7970
Epoch 140/150
50000/50000 [==============================] - 25s 507us/step - loss: 0.5145 - acc: 0.8260 - val\_loss: 0.6199 - val\_acc: 0.7942
Epoch 141/150
50000/50000 [==============================] - 25s 502us/step - loss: 0.5196 - acc: 0.8239 - val\_loss: 0.5714 - val\_acc: 0.8108
Epoch 142/150
50000/50000 [==============================] - 25s 490us/step - loss: 0.5384 - acc: 0.8198 - val\_loss: 0.6808 - val\_acc: 0.7817
Epoch 143/150
50000/50000 [==============================] - 25s 494us/step - loss: 0.4983 - acc: 0.8345 - val\_loss: 0.5860 - val\_acc: 0.8069
Epoch 144/150
50000/50000 [==============================] - 25s 490us/step - loss: 0.5156 - acc: 0.8255 - val\_loss: 0.5808 - val\_acc: 0.8085
Epoch 145/150
50000/50000 [==============================] - 25s 493us/step - loss: 0.5139 - acc: 0.8279 - val\_loss: 0.5938 - val\_acc: 0.8063
Epoch 146/150
50000/50000 [==============================] - 25s 492us/step - loss: 0.5050 - acc: 0.8270 - val\_loss: 0.5986 - val\_acc: 0.7991
Epoch 147/150
50000/50000 [==============================] - 25s 491us/step - loss: 0.5417 - acc: 0.8173 - val\_loss: 0.6062 - val\_acc: 0.8030
Epoch 148/150
50000/50000 [==============================] - 26s 521us/step - loss: 0.4975 - acc: 0.8332 - val\_loss: 0.5893 - val\_acc: 0.8107
Epoch 149/150
50000/50000 [==============================] - 25s 499us/step - loss: 0.5180 - acc: 0.8253 - val\_loss: 0.5719 - val\_acc: 0.8117
Epoch 150/150
50000/50000 [==============================] - 25s 498us/step - loss: 0.4924 - acc: 0.8344 - val\_loss: 0.6068 - val\_acc: 0.7977
10000/10000 [==============================] - 4s 359us/step

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} [0.6068103039741516, 0.7977]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{} Loss Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
          
         \PY{c+c1}{\PYZsh{} Accuracy Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} Text(0.5,1,'Accuracy Curves')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{model1}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{filepath}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./ann\PYZus{}model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{include\PYZus{}optimizer}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Continuing Training
(Testing)}\label{continuing-training-testing}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{model2} \PY{o}{=} \PY{n}{copy}\PY{p}{(}\PY{n}{model1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{5000}
         \PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{5}
         
         \PY{n}{history} \PY{o}{=} \PY{n}{model2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,} \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} 
                            \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{model2}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train on 50000 samples, validate on 10000 samples
Epoch 1/5
50000/50000 [==============================] - 23s 463us/step - loss: 0.4180 - acc: 0.8577 - val\_loss: 0.5365 - val\_acc: 0.8286
Epoch 2/5
50000/50000 [==============================] - 21s 429us/step - loss: 0.4086 - acc: 0.8616 - val\_loss: 0.5972 - val\_acc: 0.8108
Epoch 3/5
50000/50000 [==============================] - 22s 433us/step - loss: 0.4158 - acc: 0.8586 - val\_loss: 0.5444 - val\_acc: 0.8257
Epoch 4/5
50000/50000 [==============================] - 21s 428us/step - loss: 0.3893 - acc: 0.8686 - val\_loss: 0.5552 - val\_acc: 0.8224
Epoch 5/5
50000/50000 [==============================] - 22s 433us/step - loss: 0.4219 - acc: 0.8581 - val\_loss: 0.5577 - val\_acc: 0.8212
10000/10000 [==============================] - 4s 365us/step

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} [0.5577428447961807, 0.8212]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} Loss Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
          
         \PY{c+c1}{\PYZsh{} Accuracy Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}62}]:} Text(0.5,1,'Accuracy Curves')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_21_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{model3} \PY{o}{=} \PY{n}{copy}\PY{p}{(}\PY{n}{model2}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{batch\PYZus{}size} \PY{o}{=} \PY{l+m+mi}{2000}
         \PY{n}{epochs} \PY{o}{=} \PY{l+m+mi}{50}
         
         
         
         \PY{n}{history} \PY{o}{=} \PY{n}{model3}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{x\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{batch\PYZus{}size}\PY{o}{=}\PY{n}{batch\PYZus{}size}\PY{p}{,} \PY{n}{epochs}\PY{o}{=}\PY{n}{epochs}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} 
                            \PY{n}{validation\PYZus{}data}\PY{o}{=}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{model3}\PY{o}{.}\PY{n}{evaluate}\PY{p}{(}\PY{n}{x\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Loss Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
          
         \PY{c+c1}{\PYZsh{} Accuracy Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Validation Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Accuracy Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train on 50000 samples, validate on 10000 samples
Epoch 1/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4544 - acc: 0.8466 - val\_loss: 0.5417 - val\_acc: 0.8257
Epoch 2/50
50000/50000 [==============================] - 23s 460us/step - loss: 0.4531 - acc: 0.8470 - val\_loss: 0.5561 - val\_acc: 0.8225
Epoch 3/50
50000/50000 [==============================] - 22s 442us/step - loss: 0.4215 - acc: 0.8610 - val\_loss: 0.5556 - val\_acc: 0.8255
Epoch 4/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4793 - acc: 0.8411 - val\_loss: 0.5897 - val\_acc: 0.8067
Epoch 5/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4294 - acc: 0.8562 - val\_loss: 0.5763 - val\_acc: 0.8155
Epoch 6/50
50000/50000 [==============================] - 22s 442us/step - loss: 0.4483 - acc: 0.8495 - val\_loss: 0.5465 - val\_acc: 0.8280
Epoch 7/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4327 - acc: 0.8537 - val\_loss: 0.5894 - val\_acc: 0.8065
Epoch 8/50
50000/50000 [==============================] - 22s 447us/step - loss: 0.4619 - acc: 0.8469 - val\_loss: 0.5794 - val\_acc: 0.8122
Epoch 9/50
50000/50000 [==============================] - 23s 454us/step - loss: 0.4425 - acc: 0.8504 - val\_loss: 0.5741 - val\_acc: 0.8130
Epoch 10/50
50000/50000 [==============================] - 23s 461us/step - loss: 0.4639 - acc: 0.8480 - val\_loss: 0.5825 - val\_acc: 0.8152
Epoch 11/50
50000/50000 [==============================] - 22s 443us/step - loss: 0.4402 - acc: 0.8507 - val\_loss: 0.5946 - val\_acc: 0.8080
Epoch 12/50
50000/50000 [==============================] - 22s 440us/step - loss: 0.4533 - acc: 0.8498 - val\_loss: 0.5682 - val\_acc: 0.8191
Epoch 13/50
50000/50000 [==============================] - 22s 437us/step - loss: 0.4204 - acc: 0.8590 - val\_loss: 0.5664 - val\_acc: 0.8178
Epoch 14/50
50000/50000 [==============================] - 22s 436us/step - loss: 0.4494 - acc: 0.8496 - val\_loss: 0.6029 - val\_acc: 0.8011
Epoch 15/50
50000/50000 [==============================] - 22s 437us/step - loss: 0.4484 - acc: 0.8508 - val\_loss: 0.5543 - val\_acc: 0.8208
Epoch 16/50
50000/50000 [==============================] - 22s 441us/step - loss: 0.4267 - acc: 0.8565 - val\_loss: 0.5687 - val\_acc: 0.8182
Epoch 17/50
50000/50000 [==============================] - 22s 434us/step - loss: 0.4313 - acc: 0.8559 - val\_loss: 0.5564 - val\_acc: 0.8192
Epoch 18/50
50000/50000 [==============================] - 23s 460us/step - loss: 0.4617 - acc: 0.8448 - val\_loss: 0.5398 - val\_acc: 0.8230
Epoch 19/50
50000/50000 [==============================] - 22s 445us/step - loss: 0.4382 - acc: 0.8542 - val\_loss: 0.6330 - val\_acc: 0.8018
Epoch 20/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4371 - acc: 0.8541 - val\_loss: 0.5616 - val\_acc: 0.8167
Epoch 21/50
50000/50000 [==============================] - 22s 444us/step - loss: 0.4209 - acc: 0.8567 - val\_loss: 0.5511 - val\_acc: 0.8219
Epoch 22/50
50000/50000 [==============================] - 22s 444us/step - loss: 0.4282 - acc: 0.8563 - val\_loss: 0.5891 - val\_acc: 0.8050
Epoch 23/50
50000/50000 [==============================] - 22s 444us/step - loss: 0.4392 - acc: 0.8527 - val\_loss: 0.5496 - val\_acc: 0.8228
Epoch 24/50
50000/50000 [==============================] - 22s 435us/step - loss: 0.4337 - acc: 0.8548 - val\_loss: 0.5462 - val\_acc: 0.8190
Epoch 25/50
50000/50000 [==============================] - 22s 439us/step - loss: 0.4280 - acc: 0.8564 - val\_loss: 0.5384 - val\_acc: 0.8245
Epoch 26/50
50000/50000 [==============================] - 23s 459us/step - loss: 0.4120 - acc: 0.8618 - val\_loss: 0.5469 - val\_acc: 0.8226
Epoch 27/50
50000/50000 [==============================] - 22s 440us/step - loss: 0.4398 - acc: 0.8534 - val\_loss: 0.5337 - val\_acc: 0.8290
Epoch 28/50
50000/50000 [==============================] - 22s 437us/step - loss: 0.4150 - acc: 0.8605 - val\_loss: 0.6050 - val\_acc: 0.8073
Epoch 29/50
50000/50000 [==============================] - 22s 442us/step - loss: 0.4323 - acc: 0.8554 - val\_loss: 0.5470 - val\_acc: 0.8215
Epoch 30/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4283 - acc: 0.8565 - val\_loss: 0.5726 - val\_acc: 0.8198
Epoch 31/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4101 - acc: 0.8616 - val\_loss: 0.5604 - val\_acc: 0.8183
Epoch 32/50
50000/50000 [==============================] - 22s 444us/step - loss: 0.4380 - acc: 0.8534 - val\_loss: 0.5793 - val\_acc: 0.8148
Epoch 33/50
50000/50000 [==============================] - 22s 443us/step - loss: 0.4372 - acc: 0.8545 - val\_loss: 0.5496 - val\_acc: 0.8191
Epoch 34/50
50000/50000 [==============================] - 24s 471us/step - loss: 0.4175 - acc: 0.8605 - val\_loss: 0.5662 - val\_acc: 0.8170
Epoch 35/50
50000/50000 [==============================] - 22s 450us/step - loss: 0.4161 - acc: 0.8616 - val\_loss: 0.5596 - val\_acc: 0.8203
Epoch 36/50
50000/50000 [==============================] - 22s 446us/step - loss: 0.4303 - acc: 0.8550 - val\_loss: 0.5727 - val\_acc: 0.8174
Epoch 37/50
50000/50000 [==============================] - 22s 450us/step - loss: 0.4132 - acc: 0.8601 - val\_loss: 0.5557 - val\_acc: 0.8191
Epoch 38/50
50000/50000 [==============================] - 23s 455us/step - loss: 0.4444 - acc: 0.8519 - val\_loss: 0.5328 - val\_acc: 0.8287
Epoch 39/50
50000/50000 [==============================] - 23s 453us/step - loss: 0.4099 - acc: 0.8626 - val\_loss: 0.6546 - val\_acc: 0.7967
Epoch 40/50
50000/50000 [==============================] - 22s 445us/step - loss: 0.4322 - acc: 0.8558 - val\_loss: 0.5612 - val\_acc: 0.8220
Epoch 41/50
50000/50000 [==============================] - 23s 453us/step - loss: 0.4033 - acc: 0.8640 - val\_loss: 0.5810 - val\_acc: 0.8151
Epoch 42/50
50000/50000 [==============================] - 24s 483us/step - loss: 0.4275 - acc: 0.8558 - val\_loss: 0.5523 - val\_acc: 0.8252
Epoch 43/50
50000/50000 [==============================] - 23s 460us/step - loss: 0.4007 - acc: 0.8648 - val\_loss: 0.5688 - val\_acc: 0.8203
Epoch 44/50
50000/50000 [==============================] - 23s 452us/step - loss: 0.4088 - acc: 0.8614 - val\_loss: 0.5869 - val\_acc: 0.8101
Epoch 45/50
50000/50000 [==============================] - 23s 453us/step - loss: 0.4263 - acc: 0.8580 - val\_loss: 0.5468 - val\_acc: 0.8288
Epoch 46/50
50000/50000 [==============================] - 23s 455us/step - loss: 0.4083 - acc: 0.8637 - val\_loss: 0.5518 - val\_acc: 0.8236
Epoch 47/50
50000/50000 [==============================] - 23s 450us/step - loss: 0.4277 - acc: 0.8567 - val\_loss: 0.6177 - val\_acc: 0.8086
Epoch 48/50
50000/50000 [==============================] - 23s 451us/step - loss: 0.4176 - acc: 0.8593 - val\_loss: 0.5829 - val\_acc: 0.8115
Epoch 49/50
50000/50000 [==============================] - 23s 454us/step - loss: 0.4058 - acc: 0.8638 - val\_loss: 0.5330 - val\_acc: 0.8284
Epoch 50/50
50000/50000 [==============================] - 24s 478us/step - loss: 0.4429 - acc: 0.8524 - val\_loss: 0.5810 - val\_acc: 0.8129
10000/10000 [==============================] - 4s 366us/step

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}70}]:} Text(0.5,1,'Accuracy Curves')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{c+c1}{\PYZsh{} Loss Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{diff\PYZus{}loss} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{,}\PY{n}{y}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{diff\PYZus{}loss\PYZus{}cum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{diff\PYZus{}loss}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}loss}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}loss\PYZus{}cum}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}loss}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}loss\PYZus{}cum}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Accumulatve Diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Loss (Train \PYZhy{} Valid) Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Acc Curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{diff\PYZus{}acc} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{,}\PY{n}{y}\PY{p}{:} \PY{p}{(}\PY{n}{x}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)}\PY{p}{,} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{p}{,} \PY{n}{history}\PY{o}{.}\PY{n}{history}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{val\PYZus{}acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{diff\PYZus{}acc\PYZus{}cum} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{diff\PYZus{}acc}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}acc}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}acc\PYZus{}cum}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ob}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}acc}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{diff\PYZus{}acc\PYZus{}cum}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mean Accumulatve Diff}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{18}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Epochs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Acc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Acc (Train \PYZhy{} Valid) Curves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{16}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}92}]:} Text(0.5,1,'Acc (Train - Valid) Curves')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
